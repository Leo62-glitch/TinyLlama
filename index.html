<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Mini Chat avec DistilGPT-2 ðŸš€</title>
</head>
<body>
    <h1>Test Local du modÃ¨le DistilGPT-2 ðŸ§ </h1>

    <textarea id="prompt" rows="5" cols="60" placeholder="Ã‰cris ton prompt ici..."></textarea><br><br>
    <button onclick="handleClick()">Envoyer au LLM</button>

    <h2>RÃ©ponse :</h2>
    <pre id="response"></pre>

    <script type="module">
        import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.5.0';

        let pipe = null;

        async function init() {
            document.getElementById('response').innerText = "Chargement du modÃ¨le, patiente un peu...";
            pipe = await pipeline('text-generation', 'Xenova/distilgpt2');
            document.getElementById('response').innerText = "ModÃ¨le prÃªt ! Envoie un prompt ðŸš€";
        }

        async function handleClick() {
            const prompt = document.getElementById('prompt').value.trim();
            if (!pipe) {
                alert("Le modÃ¨le est encore en train de charger !");
                return;
            }
            if (prompt.length === 0) {
                alert("Ã‰cris quelque chose !");
                return;
            }
            document.getElementById('response').innerText = "GÃ©nÃ©ration en cours...";
            const out = await pipe(prompt, {
                max_new_tokens: 200,
                temperature: 0.7,
                repetition_penalty: 1.2
            });
            document.getElementById('response').innerText = out[0].generated_text;
        }

        // Initialisation
        init();
        window.handleClick = handleClick; // NÃ©cessaire pour que le bouton fonctionne
    </script>
</body>
</html>
